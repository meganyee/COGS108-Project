{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# COGS 108 - EDA Checkpoint"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Names\n",
    "\n",
    "- Megan Yee\n",
    "- Steven Bui\n",
    "- Hung Ho\n",
    "- Junmo Robbins\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Research Question"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Does playing back-to-back games in the NBA affect a player's individual performance? Specifically, does fatigue influence key performance metrics, such as points per game, shooting percentage, rebounds, and turnovers?"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Background and Prior Work"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "The NBA, also known as the National Basketball Association, consists of 82 games for each team, and there are 32 teams, in a regular season from October through April. This means that some star players could be playing back-to-back games for the team to have the best chance of winning. This leads us to our research question of does playing back-to-back games affects a player’s performance, in areas such as points per game (PPG), shooting percentage, rebounds, and turnovers. After doing some initial research about our topic, we could not find any player’s performance related to the back-to-back games, however, we could find the team’s performance related to the back-to-back games. Currently, we know that players tend to get worse on the second day of a back-to-back schedule. Thus, comparing the performance of a player when they have a one-day break to when they have a back-to-back game will allow us to get an in-depth statistic to generate a strong conclusion to the question.\n",
    "\n",
    "Previously, a similar study was conducted to determine the margin of victory by an NBA team on the second night of a back to back game. They found that at home, teams played 1 point worse on the second night, compared to 2.5 points worse if they played away.<a name=\"cite_ref-1\"></a>[<sup>1</sup>](#cite_note-1) While this information tells us that teams do in fact play worse on the second night of a back to back game, it’s a very small margin and it doesn’t account for this new resting idea in the modern NBA. More often in recent years, NBA teams have started to rest their star players in back to back games, whether this means less minutes or not playing them at all. On average, NBA teams play 16% of their games as a back to back and most commonly, they play 63% of their games with a one day break. As a result, a more accurate way to accommodate for the potential rest of players, the Sparese Impacts NBA Model was designed. <a name=\"cite_ref-2\"></a>[<sup>2</sup>](#cite_note-2) This model creates a numerical point value of a player’s worth which can be compared to a team’s performance on the second night of a back to back. While this previous study gives us an insight into how teams usually perform on the second night of a back to back, we specifically want to study individual players’ performances so we can analyze player consistency.\n",
    "\n",
    "The second study we found relating to the topic examines how back-to-back games impact NBA team performance, specifically when travel is involved. Using data from 2014-2021, the study found that teams generally perform worse on the second game of a back-to-back, with an average decline in margin of victory by 2.5 points. <a name=\"cite_ref-3\"></a>[<sup>3</sup>](#cite_note-3) Statistical analysis through Welch’s t-test confirmed a significant difference in performance, where “mean margin of victory on a back-to-back with travel” was measured at -2.33 points compared to 0.6 points without travel. This effect is even more noticeable when the teams need to travel, increasing the margin by nearly 3 points. By distinguishing games where teams travel from those where they remain at the same location, the study concludes that travel-induced fatigue may considerably impact player performance on back-to-backs, suggesting that reducing travel during these games could maintain game quality and competitiveness.\n",
    "\n",
    "1. <a name=\"cite_note-1\"></a> [^](#cite_ref-1) The Stats Behind Back to Back NBA Games *The Data Jocks*. https://thedatajocks.com/the-stats-behind-back-to-back-nba-games/#How_Often_do_Teams_Play_Back_to_Back_Games/ \n",
    "2. <a name=\"cite_note-2\"></a> [^](#cite_ref-2) Live NBA Model: Sparse Impacts Model *The Data Jocks*. https://thedatajocks.com/sparse-impacts-model-2023/ \n",
    "3. <a name=\"cite_note-3\"></a> [^](#cite_ref-3) Analyzing the Impact of Back-to-Backs on NBA Team Performance *Medium*. https://medium.com/@kevhopper92/analyzing-the-impact-of-back-to-backs-on-nba-team-performance-88a4b80a5d99#:~:text=Travel%20during%20a%20Back-to,a%20back-to-back/ \n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Hypothesis\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "We predict that NBA players will experience a significant decrease in key performance metrics during the second game of back-to-back games compared to their performance in games with at least a day of rest. Not only can fatigue affect a player’s physical abilities, but can also negatively impact their cognitive functions which may lead to an increase in turnovers.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Data"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Data overview\n",
    "\n",
    "- Dataset #1\n",
    "  - Dataset Name: Combined Stats from Unique Players\n",
    "  - Link to the dataset: https://github.com/COGS108/Group123-FA24/blob/master/Combined_Unique_Stats.csv\n",
    "  - Number of observations: 92\n",
    "  - Number of variables: 4\n",
    "- Dataset #2\n",
    "  - Dataset Name: Generated Back to Back Games\n",
    "  - Link to the dataset:https://github.com/COGS108/Group123-FA24/blob/master/Generated_Back_to_Back_Games.csv\n",
    "  - Number of observations: 424\n",
    "  - Number of variables: 4\n",
    "\n",
    "For our first dataset, instead of analyzing every NBA player's statistics, we selected the top 50 players from last season based on their highest averages in points per game, rebounds, and turnovers. We then removed any duplicate players appearing across multiple lists and narrowed the columns to display each player’s team and the three key metrics we plan to analyze.\n",
    "Our second dataset includes the NBA schedule for all back-to-back games played by each team last season. We first gathered the full schedule and identified back-to-back games by finding those played with exactly one day between them. These dates will allow us to track each of the top 50 players’ individual statistics for these specific games.\n",
    "Finally, we will combine these datasets to show each player’s stats for every back-to-back game they played. By comparing their averages in the first game of a back-to-back to their averages in the second, we aim to understand how fatigue affects an NBA player’s performance.\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Dataset #1 (Player Performance Metrics)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Load CSV files\n",
    "points_df = pd.read_csv('Pts_per_Game.csv', index_col=0)\n",
    "turnover_df = pd.read_csv('Turnover.csv', index_col=0)\n",
    "rebound_df = pd.read_csv('Rebound.csv', index_col=0)\n",
    "\n",
    "# Combine dataframes\n",
    "combined_df = pd.concat([points_df, turnover_df, rebound_df], ignore_index=True)\n",
    "\n",
    "# Drop duplicate players\n",
    "unique_combined_df = combined_df.drop_duplicates(subset=['Player', 'TEAM'])\n",
    "\n",
    "# Keep only the specified columns\n",
    "unique_combined_df = unique_combined_df[['Player', 'TEAM', 'PTS', 'TOV', 'REB']]\n",
    "\n",
    "# Save the filtered DataFrame to a new CSV file\n",
    "unique_combined_df.to_csv('Combined_Unique_Players.csv', index=False)\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Dataset #2 (Back-to-Back Games Schedule Filtering)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Load the NBA schedule CSV file\n",
    "nba_schedule = pd.read_csv('NBA_Schedule.csv')\n",
    "\n",
    "# Convert the Date column to datetime format\n",
    "nba_schedule['Date'] = pd.to_datetime(nba_schedule['Date'], errors='coerce')\n",
    "\n",
    "# Remove any extra whitespace\n",
    "nba_schedule['Visitor/Neutral'] = nba_schedule['Visitor/Neutral'].str.strip()\n",
    "nba_schedule['Home/Neutral'] = nba_schedule['Home/Neutral'].str.strip()\n",
    "\n",
    "# Create separate DataFrames for visitor and home games and rename\n",
    "visitor_games = nba_schedule[['Date', 'Visitor/Neutral']].rename(columns={'Visitor/Neutral': 'Team'})\n",
    "home_games = nba_schedule[['Date', 'Home/Neutral']].rename(columns={'Home/Neutral': 'Team'})\n",
    "\n",
    "# Combine visitor and home games into a single schedule\n",
    "team_schedule = pd.concat([visitor_games, home_games], ignore_index=True)\n",
    "team_schedule = team_schedule.sort_values(by=['Team', 'Date']).reset_index(drop=True)\n",
    "\n",
    "# Identify back-to-back games\n",
    "team_schedule['Previous_Game_Date'] = team_schedule.groupby('Team')['Date'].shift(1)\n",
    "team_schedule['Back_to_Back'] = (team_schedule['Date'] - team_schedule['Previous_Game_Date']).dt.days == 1\n",
    "\n",
    "# Filter to include only the back-to-back games\n",
    "back_to_back_games = team_schedule[team_schedule['Back_to_Back']]\n",
    "\n",
    "# Save the back-to-back games to a new CSV file\n",
    "back_to_back_games.to_csv('Generated_Back_to_Back_Games.csv', index=False)\n",
    "\n"
]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Results\n",
    "\n",
    "## Exploratory Data Analysis\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Section 1 of EDA - Scatterplots and Boxplots for Stats, First and Second day B2B games\n",
    "\n",
    "We used scatterplots and boxplots to compare player performance on the first and second days of back-to-back games. The scatterplots show how points, rebounds, and turnovers on Day 1 compare to Day 2, but they’re hard to interpret because so many points overlap. To address this, we added boxplots, which make it easier to spot overall trends. From the boxplots, we see that points scored drop slightly on Day 2, while rebounds and turnovers remain about the same. This suggests fatigue might impact scoring more than other parts of the game, but further analysis is needed to confirm this."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
       "import pandas as pd\n",
       "import matplotlib.pyplot as plt\n",
       "\n",
       "# Load the datasets for the first and second days of back-to-back games\n",
       "first_day_df = pd.read_csv(\"Back_to_Back_First_Day.csv\")\n",
       "second_day_df = pd.read_csv(\"Back_to_Back_Second_Day.csv\")\n",
       "\n",
       "# Merge the datasets on PLAYER NAME\n",
       "merged_df = pd.merge(first_day_df, second_day_df, on='PLAYER NAME', suffixes=('_Day1', '_Day2'))\n",
       "\n",
       "# Metrics to visualize\n",
       "metrics = ['PTS', 'REB', 'TOV']\n",
       "\n",
       "# Scatter plots for each metric\n",
       "for metric in metrics:\n",
       "    plt.figure(figsize=(8, 6))\n",
       "    plt.scatter(merged_df[f'{metric}_Day1'], merged_df[f'{metric}_Day2'], alpha=0.7)\n",
       "    plt.title(f'{metric}: First Day vs. Second Day of Back-to-Back Games')\n",
       "    plt.xlabel(f'{metric} on First Day')\n",
       "    plt.ylabel(f'{metric} on Second Day')\n",
       "    plt.axline((0, 0), slope=1, color='red', linestyle='--')\n",
       "    plt.legend()\n",
       "    plt.grid(True)\n",
       "    plt.show()\n",
       "\n",
       "# Box plots comparing Day 1 and Day 2 for each metric\n",
       "plt.figure(figsize=(12, 8))\n",
       "for i, metric in enumerate(metrics, 1):\n",
       "    plt.subplot(1, 3, i)\n",
       "    merged_df[[f'{metric}_Day1', f'{metric}_Day2']].boxplot()\n",
       "    plt.title(f'{metric}: Day 1 vs Day 2')\n",
       "    plt.ylabel(metric)\n",
       "    plt.xticks([1, 2], ['Day 1', 'Day 2'])\n",
       "plt.tight_layout()\n",
       "plt.show()\n"
   ]
},
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Section 2 of EDA - Means, T-Stat, P-Value\n",
    "\n",
    "We used the same metrics and dataset from Section 1 to conduct a paired t-test for each metric, comparing Day 1 and Day 2 of the back-to-back games. We also calculated the p-value for each metric to determine the statistical significance. Our results showed that the differences in the mean values for each stat between the two days were minor, showing that the metrics are very similar overall. However, with the p-value at the 0.05 significance level, the p-values showed that there is significant change for PTS and RBS but not for TOV."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
       "import pandas as pd\n",
       "from scipy.stats import ttest_rel\n",
       "\n",
       "# Load the datasets for the first and second days of back-to-back games\n",
       "first_day_df = pd.read_csv(\"Back_to_Back_First_Day.csv\")\n",
       "second_day_df = pd.read_csv(\"Back_to_Back_Second_Day.csv\")\n",
       "\n",
       "# Merge the datasets on PLAYER NAME\n",
       "merged_df = pd.merge(first_day_df, second_day_df, on='PLAYER NAME', suffixes=('_Day1', '_Day2'))\n",
       "\n",
       "# Metrics to analyze\n",
       "metrics = ['PTS', 'REB', 'TOV']\n",
       "\n",
       "# Dictionary to store the metrics summary\n",
       "metrics_summary = {}\n",
       "for metric in metrics:\n",
       "    day1_mean = merged_df[f'{metric}_Day1'].mean()\n",
       "    day2_mean = merged_df[f'{metric}_Day2'].mean()\n",
       "    t_stat, p_value = ttest_rel(merged_df[f'{metric}_Day1'], merged_df[f'{metric}_Day2'])\n",
       "    metrics_summary[metric] = {\n",
       "        'Day 1 Mean': day1_mean,\n",
       "        'Day 2 Mean': day2_mean,\n",
       "        'Difference': day1_mean - day2_mean,\n",
       "        'T-Statistic': t_stat,\n",
       "        'P-Value': p_value\n",
       "    }\n",
       "\n",
       "# Convert the metrics summary to a DataFrame\n",
       "metrics_summary_df = pd.DataFrame(metrics_summary).T\n",
       "\n",
       "# Save the summary DataFrame to a CSV file\n",
       "updated_file_path = \"MetricSummary.csv\"\n",
       "metrics_summary_df.to_csv(updated_file_path, index=False)\n"
   ]
}
,
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Ethics & Privacy"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Since our project uses publicly available NBA player statistics, privacy concerns are minimal. However, we recognize that some biases might affect our results. For example, certain players may get more rest depending on their team’s schedule, which could skew performance data in favor of some teams over others. Additionally, factors like travel, injuries, and coaching strategies can influence performance but aren’t directly reflected in our dataset. We’ll note these limitations and interpret our results with these in mind."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Team Expectations "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "* *Our team will communicate through Discord. A reasonable response time for a message would be within 12 hours. Our team will meet twice a week, in discord, in order to get our work done.*\n",
    "* *We will actively communicate with each other right when any problem arises so that we can work with it as soon as possible. We will reach out to each other for help if needed.*\n",
    "* *Since we value each other’s opinion, during a decision making process, our team decision would mainly be based on consensus decision-making after a debate.*\n",
    "* *We will split the workload among everyone, so that everyone will contribute a bit of everything to the team. We will mostly work together while calling on discord, so assigning work to everyone will happen during the call.*\n",
    "* *If someone is struggling to deliver something they promised to do, reach out to the team as soon as possible for help. If things cannot be resolved within the team, reach out to the IA or TA for extra help.*\n",
    "* *Make sure to keep updating the project timeline proposal in order to keep up with deadlines and plan ahead.*\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Project Timeline Proposal"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "| Meeting Date  | Meeting Time | Completed Before Meeting | Discuss at Meeting |\n",
    "|---------------|--------------|--------------------------|---------------------|\n",
    "| 10/22         | 8 PM         | Read through past projects and discuss team goals | Complete the project review form together, set team expectations, and start brainstorming research questions |\n",
    "| 10/29         | 9 PM         | Finalize a research question through Discord and complete background research | Work on project proposal draft together, completing most of it as a team; assign remaining tasks for individual work |\n",
    "| 10/30         | 8 PM         | Complete assigned sections from previous meeting | Review, finalize, and submit the project proposal |\n",
    "| 11/5          | 8 PM         | Gather and import data; start initial research focusing on player performance metrics | Review data for completeness and outline the analysis plan based on initial findings |\n",
    "| 11/12         | 8 PM         | Create CSV files with our datasets and combine them according to our project | Review, finalize, and submit the DataCheckpoint. |\n",
    "| 11/19         | 8 PM         | Complete detailed research and clean any remaining data | Discuss research results and make adjustments to the analysis plan if needed |\n",
    "| 11/25         | 8 PM         | Create a google sheet and manually combining data of each player for each game across the chosen season | Continue to manually combining data, discuss how these data help answer the research question and plan the analysis |\n",
    "| 11/26         | 9 PM         | Begin full analysis based on research insights, focusing on metrics for fatigue impact | Review analysis progress, discuss preliminary findings, and start drafting results and conclusions |\n",
    "| 12/11         | Before 11:59 PM | Finalize all results and conclusions; record presentation | Final review of project deliverables, and submit all materials, including team surveys |\n"

   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
